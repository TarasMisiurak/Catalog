<%= link_to "All posts", posts_path %>

<%= form_for @post do |f| %>
  <% if @post.errors.any? %>
    <div id="error_explanation">
      <h2>
        <%= "#{pluralize(@post.errors.count, "error")} prohibited this post from being saved:" %>
      </h2>
      <ul>
        <% @post.errors.full_messages.each do |msg| %>
          <li>
            <%= msg %>
          </li>
          <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= f.text_field :title, class: "form-control" %>
  </div>

  <div class="form-group">
    <%= f.text_area :body, class: "form-control" %>
  </div>

  <% if @post.image? %>
   <% link_to image_tag(@post.image.url(:small), class: 'media-object'), @post.image.url, target: '_blank' %>
   <% link_to "Remove image", post_path(@post),
      method: :delete_image,
      data: { confirm: 'Are you sure?' } %>
  <% end %>

  <div class="form-group">
    <p>Add an image</p>
    <%= f.file_field :image, class: 'form-control' %>
  </div>

  <%= select_tag(:category_id, options_for_select(@categories, @post.category_id), prompt: "Select category") %>

  <div class="form-group">
    <% if current_page?(new_post_path) %>
      <%= f.submit "Create Post" %>
    <% elsif current_page?(edit_post_path) %>
      <%= f.submit "Update Post" %>
    <% end %>
  </div>
<% end %>

<% if current_page?(new_post_path) %>
  <%= link_to "Back", posts_path %>
<% elsif current_page?(edit_post_path(@post)) %>
  <%= link_to "Back to post", post_path(@post) %>
<% end %>